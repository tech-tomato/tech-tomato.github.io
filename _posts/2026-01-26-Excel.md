---
layout:     post
title:      "关于Excel"
subtitle:   "VBA"
date:       2026-01-26
author:     "allen"
header-img: "图片"
tags:
    - vba
    -
    - 
---
## EXCEL保护破解
```
Sub DeletePW()

ActiveSheet.Protect DrawingObjects:=True, Contents:=True, AllowFiltering:=True

ActiveSheet.Protect DrawingObjects:=False, Contents:=True, AllowFiltering:=True

ActiveSheet.Protect DrawingObjects:=True, Contents:=True, AllowFiltering:=True

ActiveSheet.Protect DrawingObjects:=False, Contents:=True, AllowFiltering:=True

ActiveSheet.Unprotect

End Sub
```
## 无法在EXCEL内删除工作表页破解
```
Sub 工作簿密码破解()

ActiveWorkbook.Sheets.Copy

For Each sh In ActiveWorkbook.Sheets

sh.Visible = True

Next

End Sub
```
## 选择行和列高亮
```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
With Target
.Parent.Cells.Interior.ColorIndex = xlNone
.EntireRow.Interior.ColorIndex = 6
.EntireColumn.Interior.ColorIndex = 6
End With
End Sub
```
- **高亮代码**
    按Alt+F11键调出VBA窗口，在编辑区输入以下高亮代码： 
```  
Private Sub Workbook_SheetSelectionChange(ByVal Sh As Object, ByVal Target As Range)

Sh.Cells.Interior.ColorIndex = xlNone

Target.EntireColumn.Interior.ColorIndex = 20

Target.EntireRow.Interior.ColorIndex = 20

End Sub
```
## 随机数 公差
```
=ROUND((RAND()*(0.5-0.3)+0.3),1)
```
